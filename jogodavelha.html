<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VM - Jogo da VelhA</title>
    <!-- <link rel="stylesheet" href="style.css"> -->
</head>

<body>
    <div class="main">
        <p>Jogador jogou: <span class="jogador"> aguardando</span>.</p>
        <p>Computador jogou: <span class="computador">aguardando..</span>.</p>
        <h2>Resultado: <span class="resultado"></span></h2>
        <h3>Jogador: <span class="pontos-jogador">0</span> x <span class="pontos-computador">0</span> :Computador</h3>
        <p>Rodada: <span class="rodada"></span></p>
        <button class="pedra">Pedra</button>
        <button class="papel">Papel</button>
        <button class="tesoura">Tesoura</button>
    </div>

    <script>
        const jogador = document.querySelector('.jogador');
        const computador = document.querySelector('.computador');
        const botoes = document.querySelectorAll('.main button');
        const resultado = document.querySelector('.resultado');
        const pontosJogador = document.querySelector('.pontos-jogador');
        const pontosComputador = document.querySelector('.pontos-computador');
        const opcoesJogadas = ['pedra', 'papel', 'tesoura'];


        async function jogadaJogador() {
            botoes.forEach(botao => {
                botao.addEventListener('click', () => {
                    jogador.innerHTML = botao.getAttribute('class');
                })
            })
        }

        async function jogadaComputador() {
            botoes.forEach(botao => {
                botao.addEventListener('click', () => {
                    const x = Math.floor(Math.random() * (3 - 1 + 1) + 1);
                    computador.innerHTML = opcoesJogadas[x - 1];
                })
            })
        }

        let j = '';
        let c = '';
        function validarJogadas() {
            botoes.forEach((botao) => {
                botao.addEventListener('click', () => {
                    j = jogador.innerHTML;
                    c = computador.innerHTML;
                })
            })
        }

        function compararJogadas() {
            botoes.forEach(botao => {
                botao.addEventListener('click', () => {
                    let res = '';
                    if (j === c) {
                        res = 'empate';
                    } else if (j === 'pedra' && c === 'tesoura' || j === 'papel' && c === 'pedra' || j === 'tesoura' && c === 'papel') {
                        res = 'jogador venceu';
                    } else if (c === 'pedra' && j === 'tesoura' || c === 'papel' && j === 'pedra' || c === 'tesoura' && j === 'papel') {
                        res = 'computador venceu';
                    }
                    resultado.innerHTML = res;
                })
            })
        }

        let pJogador = 0;
        let pComputador = 0;
        function contadorPontos() {
            botoes.forEach((botao) => {
                botao.addEventListener('click', () => {
                    if (resultado.innerHTML === 'jogador venceu') {
                        pJogador += 1;
                    } else if (resultado.innerHTML === 'computador venceu') {
                        pComputador += 1;
                    }
                    pontosJogador.innerHTML = pJogador;
                    pontosComputador.innerHTML = pComputador;
                    fimJogo();
                })
            })
        }

        function fimJogo() {
            if (pontosJogador.innerHTML === 3 || pontosComputador.innerHTML === 13) {
                pJogador = 0;
                pComputador = 0;
                if (pontosJogador.innerHTML === 3) {
                    alert('Fim de jogo!\nJogador é o grande vencedor!')
                } else if (pontosComputador.innerHTML === 3) {
                    alert('Fim de jogo!\Computador é o grande vencedor!')
                }
            }
        }


        function rodarJogo() {
            jogadaJogador();
            jogadaComputador();
            validarJogadas();
            compararJogadas();
            contadorPontos();
        }

        rodarJogo();

    </script>

    <style>
        body {
            margin: 0;
            padding: 0;
        }

        button {
            min-width: 65px;
            border-radius: 0px;
            border: 1px solid black;
        }
    </style>


</body>

</html>